## 目的
<!-- 目的(〜を知りたい/〜を実装したい) -->
Javaのspringに触れてみる
## 成果
<!-- 成果(できたこと/できなかったこと) -->
- [] AWS 復習
- [x] Java spring実装
- []
#### 所要時間
- ◯m
  - 120m(9:00-11:00): Thymeleaf/HelloWorld実装
  - 420m(11:00-18:00): JPAでデータベースに接続
#### 使用資料
<!-- 使用資料(教材/書籍/ワークシート/Youtube) -->

## 詳細
<!-- 詳細(キーワード/プロセス//具体例を挙げる/今回の課題解決を今後に繋げられる形で記録) -->
### Thymeleaf/HelloWorld実装
- Thymeleafはテンプレートエンジン
- [参考/公式](https://www.thymeleaf.org/doc/tutorials/3.0/usingthymeleaf_ja.html)
- Pra0805Application`はこのプロジェクト（pra0805）の「入り口（エントリーポイント）」

### JPAでデータベースに接続
- [参考](https://medium-company.com/spring-boot%ef%bc%8bjpa%e3%81%a7%e3%83%87%e3%83%bc%e3%82%bf%e3%83%99%e3%83%bc%e3%82%b9%e3%81%ab%e6%8e%a5%e7%b6%9a%e3%81%99%e3%82%8b%e6%96%b9%e6%b3%95/)
- JPAとは、Java Persistence API
  - リレーショナルデータベースで管理されているレコードを、Javaオブジェクトにマッピング
  - マッピングされたJavaオブジェクトに対して行われた操作を、リレーショナルデータベースのレコードに反映
  - ディレクトリ：`/Applications/Eclipse_2025-06.app/Contents/workspace`
  - コンテナに入る：`docker exec -it pra0805-db-1 mysql -u root -p`
  - [参考](https://spring-boot.jp/database/overview/64#mokuji_8)
    - Railsとの比較
    ```
    |Rails     |Java（Spring Boot＋JPA） |役割            |
    |----------|----------------------|--------------|
    |モデル（Model）|Entity（エンティティ）        |データベースのテーブルに対応|
    |コントローラ    |Controller（コントローラ）    |リクエスト処理・画面遷移  |
    |          |Repository（リポジトリ）     |データベース操作の窓口   |
    |          |Service（サービス）         |ビジネスロジック      |
    |ビュー（View） |HTMLテンプレート（Thymeleaf等）|画面表示          |
    ```
    - まずEntityクラスを作成（dbテーブルと対応するJavaクラス）
      - @(アノテーション)が必要なのはクラスと主キー
      ```java
      @Entity
      public class Book{
          @Id //主キー
          private Long id;
          private String title;
          private String author;
      }
      ```
    - 次にRepositoryクラスを作成（Entityを通じてdbにアクセスするための入り口）
    - データ保存・削除・検索などの処理を行う役割
      - Book Entityに対して、Repository作成
      - JpaRepositorfindByTitleyという、インターフェースを継承→基本的なデータ操作メソッドが自動的に使える
      - findByTitle：タイトルを条件に検索できる
      ```java
      public interface BookRepository extends JpaRepository<Book, Long> {
          List<Book> findByTitle(String title);
      }
      ```
    - 最後にServiceクラスを作成（ビジネスロジックを担当）
    - Repositoryを使用してdbとやりとりをしつつ必要な処理をServiceクラスで行い、Contrillerからのリクエストに応じた結果を返す役割
      ```java
      @Service
      public final BookService {
          private final BookRepository repository;  //BookServiceの中でだけ使えるかつ、finalでインスタンス時以外値変更なし

          publiv BookService(BookRepository repository) {
              this.repository = repository;
          }

          public List<Book> getAllBooks() {
              return repository.findByTitle(title);
          }
      }
    - 全体の流れ：ブラウザからリクエスト->controllerで受け取りserviceを呼び出す
      ->serviceがrepositoryを使ってdbからデータ取得
      ->取得データをcontollerへ返す
      ->contollerがviewへデータを渡して表示
        ```java
        @Controller
        ///booksというURLにアクセスがあったときに、Serviceを呼び出してデータを取得
        public class BookController {
            private final BookService bookService;

            //Springが`BookService`のインスタンスを自動で作って`BookController`のコンストラクタに渡す
            @Autowired
            public BookController(BookService bookService) {
                this.bookService = bookService;
            }

            @GetMapping("/books")
            //取得したList<Book>のデータをModelに格納
            public String listBooks(Model model) {
                List<Book> books = bookService.getAllBooks();
                model.addAttribute("books, books);
                return "book-list";
            }
        }
        ```

## 考察
<!-- 考察(今後の展望/) -->
Eclipseを使いこなしたいという理由もあるけど、使い心地があまり良くない...
VSCodeで書きたくなる...
